<%= form_with model: [:admin, @product], local: true do |f| %>
  <div class="space-y-6 bg-white p-6 rounded-xl shadow-lg">

    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Thông tin sản phẩm</h2>

    <div>
      <%= f.label :name, "Tên sản phẩm", class:"block font-medium mb-1" %>
      <%= f.text_field :name,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <div>
      <%= f.label :price, "Giá", class:"block font-medium mb-1" %>
      <%= f.number_field :price, step: 1,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <div>
      <%= f.label :size, "Kích thước", class:"block font-medium mb-1" %>
      <%= f.text_field :size,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <div>
      <%= f.label :material, "Chất liệu", class:"block font-medium mb-1" %>
      <%= f.text_field :material,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <div class="flex items-center gap-2">
      <%= f.check_box :featured %>
      <%= f.label :featured, "Sản phẩm nổi bật" %>
    </div>
    

    <div class="flex items-center gap-2">
      <%= f.check_box :promotion %>
      <%= f.label :promotion, "Sản phẩm giảm giá" %>
    </div>

    <div>
      <%= f.label :new_price, "Giá sau khi được giảm giá(không thì bỏ trống)", class:"block font-medium mb-1" %>
      <%= f.number_field :new_price, step: 1,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <!-- Mô tả -->
    <div>
      <%= f.label :description, "Mô tả", class:"block font-medium mb-1" %>
      <%= f.text_area :description, rows: 4,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring focus:ring-blue-300 focus:outline-none" %>
    </div>

    <!-- Danh mục -->
    <div>
      <%= f.label :category_id, "Danh mục", class:"block font-medium mb-1" %>
      <%= f.collection_select :category_id, Category.all, :id, :name,
            { prompt: "Chọn danh mục" },
            { class: "w-full border border-gray-300 rounded-lg px-3 py-2 bg-white focus:ring focus:ring-blue-300 focus:outline-none" } %>
    </div>

    <!-- Ảnh sản phẩm -->
    <div>
      <%= f.label :images, "Ảnh sản phẩm", class:"block font-medium mb-1" %>
      <%= f.file_field :images, multiple: true,
        class: "w-full border border-gray-300 rounded-lg px-3 py-2 bg-white" %>
    </div>

    <!-- Nút Lưu -->
    <div class="pt-4">
      <%= f.submit "Lưu sản phẩm",
        class:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition" %>
    </div>

  </div>
<% end %>


<% if @product.images.attached? %>
  <div class="grid grid-cols-3 gap-4 mt-6">
    <% @product.images.order(created_at: :desc).each do |image| %>
      <div class="flex items-center space-x-4">
        
        <%= image_tag image, class: "w-48 h-48 object-cover rounded border" %>

        <!-- Nút Xóa -->
        <%= button_to "Xóa",
            remove_image_admin_product_path(@product, image_id: image.id),
            method: :delete,
            class: "px-3 py-2 bg-red-500 text-white rounded" %>

        <!-- Nút Thay Ảnh -->
        <%= form_with url: change_image_admin_product_path(@product, image_id: image.id),
                      method: :patch,
                      html: { multipart: true } do |f| %>
          <label class="px-3 py-2 bg-blue-500 text-white rounded cursor-pointer">
            Thay ảnh
            <%= f.file_field :image, class: "hidden", onchange: "this.form.submit()" %>
          </label>
        <% end %>

      </div>
    <% end %>
  </div>
<% end %>
