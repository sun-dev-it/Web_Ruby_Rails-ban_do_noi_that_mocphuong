<% if @products_search.present? %>
  <div class="flex justify-center mb-4">
    <div class="w-[95%] sm:w-[85%] grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-8 mt-4 px-2 sm:px-4">

      <% @products_search.each do |product| %>
        <%= link_to product_path(product),
              class: "bg-white group block border border-transparent
                      hover:border-[#cecece] transition" do %>

          <div class="transition-all duration-300 overflow-hidden">
            <div class="relative overflow-hidden aspect-[4/3]">

              <% if product.images.count >= 2 %>

                <%= image_tag product.images[0],
                      class: "absolute inset-0 w-full h-full object-cover
                              transition-all duration-700 ease-in-out
                              opacity-100 group-hover:opacity-0
                              group-hover:scale-110" %>

                <%= image_tag product.images[1],
                      class: "absolute inset-0 w-full h-full object-cover
                              transition-all duration-700 ease-in-out
                              opacity-0 group-hover:opacity-100
                              group-hover:scale-110" %>

              <% else %>
                <%= image_tag product.images.first, class: "w-full h-full object-cover
                              transition-transform duration-700
                              group-hover:scale-110" %>
              <% end %>

              <div class="absolute inset-0 bg-black/30
                          opacity-0 group-hover:opacity-100
                          transition duration-500"></div>

              <p class="absolute bottom-0 mb-3 left-0 right-0
                        text-white text-sm p-4
                        translate-y-6 opacity-0
                        group-hover:translate-y-0 group-hover:opacity-100
                        transition-all duration-500 line-clamp-2">
                <%= truncate(product.description, length: 120) %>
              </p>
            </div>

            <div class="p-5">
              <p class="text-xs font-semibold text-gray-700
                        group-hover:text-black transition">
                <%= product.category.name %>
              </p>

              <h3 class="text-base font-semibold text-gray-700
                         group-hover:text-black transition">
                <%= product.name %>
              </h3>

              <div class="flex">
                <p class="text-sm font-sans font-bold text-gray-500 mt-2 text-right line-through">
                  <%= number_to_currency(product.price,
                        unit: "VND ",
                        format: "%n %u",
                        precision: 0) %>
                </p>
                <p class="text-sm font-sans font-bold text-red-500 mt-2 text-right">
                  <%= number_to_currency(product.new_price,
                        unit: "VND ",
                        format: "%n %u",
                        precision: 0) %>
                </p>
              </div>        
              <div class="mt-4 text-right">
                <%= button_to "Thêm vào giỏ",
                      add_cart_path(product_id: product.id),
                      method: :post,
                      form: { data: { remote: true } },
                      class: "bg-gray-300 text-gray-800 px-4 py-2 rounded
                              hover:bg-gray-400 transition" %>
              </div>
            </div>

          </div>
        <% end %>
      <% end %>

    </div>
  </div>
<% else %>
  <p class="flex justify-center mb-4">Không có kết quả tìm kiếm</p>
<% end %>
