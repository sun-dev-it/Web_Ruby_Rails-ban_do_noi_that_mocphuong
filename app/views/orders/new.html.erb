<h1>Xác nhận đơn hàng</h1>

<% if @cart_items.empty? %>
  <p>Giỏ hàng của bạn trống!</p>
  <%= link_to "Quay lại mua hàng", products_path %>
<% else %>
  <table border="1" cellpadding="6">
    <thead>
      <tr>
        <th>Sản phẩm</th>
        <th>Số lượng</th>
        <th>Giá</th>
        <th>Thành tiền</th>
      </tr>
    </thead>

    <tbody>
      <% total = 0 %>
      <% @cart_items.each do |item| %>
        <% total += item.quantity * item.product.price %>
        <tr>
          <td><%= item.product.name %></td>
          <td><%= item.quantity %></td>
          <td><%= number_to_currency(item.product.price, unit: "VND", precision: 0) %></td>
          <td><%= number_to_currency(item.quantity * item.product.price, unit: "VND", precision: 0) %></td>
        </tr>
      <% end %>

      <tr>
        <td colspan="3"><strong>Tổng tiền</strong></td>
        <td><strong><%= number_to_currency(total, unit: "VND", precision: 0) %></strong></td>
      </tr>
    </tbody>
  </table>

  <br>

  <%= form_with url: orders_path, method: :post do %>
    <%= submit_tag "Xác nhận đặt hàng", class: "btn btn-primary" %>
  <% end %>

  <%= link_to "Quay lại giỏ hàng", cart_path, class: "btn btn-secondary" %>
<% end %>
